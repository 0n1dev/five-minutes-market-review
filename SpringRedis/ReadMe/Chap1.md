# Redis

> Remote Dictionary Server의 약자

- K-V 구조의 비정형 데이터를 저장하고 관리
- 비관계형 데이터베이스 관리 시스템
- 메모리 기반
- 싱글 쓰레드
- 스냅샷을 뜰 때, 자식 프로세스를 하나 만든 후 새로 변경된 메모리 페이지를 복사해서 사용
- String, set, sorted-set, hashes, list 등 다양한 타입 지원

-> 속도가 빠르고 주로 캐시의 용도로 사용

## 비교대상

- MemCached
    - DB / API 통신을 줄이기 위해 데이터를 캐싱처리하는 데 사용 하면 좋음
    - 트래픽이 물려도 응답 속도는 안정적인 편
    - 내부적으로 slab 할당자를 사용하고 있어서 메모리 파편화 문제가 덜함 (한 번 입력후, 변경되지 않는 정보를 저장할 때 유용)
    - 레디스에 비해 메타 데이터를 적게 사용하기 때문에 메모리 사용량이 상대적으로 낮다

- 비교
    - 성능차이는 크지 않으나 캐시 업데이트가 빈번한 경우 Redis가 오히려 성능이 잘 나오는 경우가 있음
    - 메모리가 날라가서 서비스 장애가 발생할 수 있는 상황이라면, Redis에 저장하는게 좋음
    - 메모리가 날라가도, 원본 데이터로 즉시 복구할 수 있는 데이터는 Memcached에 저장하는게 좋음

## Cache란?

> 요청된 결과를 미리 저장하여, 추후 동일한 요청에 제공하는 것

### Cache 구조

- Look asid Cache: 캐시에 자료가 없으면, DB 접근 후 캐시에 갱신
- Write Back: 캐시에 쓰고, 모아서 DB에 저장

## Redis 사용 사례

> Redis는 인 메모리를 사용하기 때문에 속도가 빠름

- 인증 토큰 저장소
- 랭킹 보드 (Sorted Set)
- 유저 API Limit
- Job Queue
- Remote Data Store
- ETC...

## Redis에게 Collection이란?

> Redis는 다양한 데이터 구조를 제공

- 개발의 편의성
    - 랭킹 서버를 구현할 때 Redis의 `Soreted Set`을 이용하면 랭킹을 쉽게 구현 가능
- 개발의 난이도
    - 제공 라이브러리 사용을 통해 개발 가능

※ Redis의 자료구조는 `Atomic`하지만, 코드를 잘못 작성하거나 쓰기 요청을 연달아 두 번 하게 되는 불상사를 발생시키는 경우에 `Race Condition`이 발생

### 주의사항

- 하나의 컬렉션에 너무 많은 아이템을 담으면 좋지 않음 (만개 이하 몇 천개 수준으로 유지하는게 좋음)
- Expire는 Collection의 item 개별로 걸리지 않고 전체 Collection에 대해서만 걸림